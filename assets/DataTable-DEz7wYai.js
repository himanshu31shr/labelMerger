import{j as e,aJ as ie,aK as ee,aL as M,R as V,aM as oe,B as b,J as te,X as W,b as T,I as L,aO as le,aP as de,p as ce,D as he,K as _,a_ as xe,aG as ue,bt as pe,a6 as ge,ab as fe,ac as je,ae as be,a1 as $,c as Y,aj as me,u as Ce,h as Se,a5 as ve,bu as Z,aH as ye,aI as Pe,aN as ke}from"./mui-vendor-tGclxw8b.js";import{a as w,b as S}from"./react-vendor-DYr15v6v.js";function Te(l){const{columns:o,orderBy:p,order:m,filters:d,onRequestSort:C,onFilterChange:h,enableSelection:f,selected:r=[],onSelectAll:x,visibleRowIds:u=[]}=l,i=u.length>0&&u.every(t=>r.includes(t)),g=u.some(t=>r.includes(t));return e.jsx(ie,{children:e.jsxs(ee,{children:[f&&e.jsx(M,{padding:"checkbox",children:e.jsx(V,{indeterminate:g&&!i,checked:i,onChange:t=>x==null?void 0:x(t.target.checked,u),inputProps:{"aria-label":"select all"}})}),o.map(t=>e.jsxs(M,{align:t.align,sortDirection:p===t.id?m:!1,children:[e.jsx(oe,{active:p===t.id,direction:p===t.id?m:"asc",onClick:()=>C(t.id),children:t.label}),t.filter&&e.jsx(b,{sx:{mt:1},children:e.jsx(te,{size:"small",placeholder:`Filter ${t.label}`,value:d[t.id]||"",onChange:I=>h(t.id,I.target.value),fullWidth:!0})})]},String(t.id)))]})})}const we=w.memo(Te);function Ie(l){const{row:o,columns:p,index:m,onClick:d,enableSelection:C,selected:h=!1,onSelect:f,rowId:r}=l,x=i=>{i.stopPropagation(),f&&r!==void 0&&f(r,i.target.checked)},u=i=>{i.stopPropagation()};return e.jsxs(ee,{hover:!0,onClick:()=>d==null?void 0:d(o),sx:{cursor:d?"pointer":"default"},children:[C&&e.jsx(M,{padding:"checkbox",onClick:u,children:e.jsx(V,{checked:h,onChange:x,inputProps:{"aria-label":"select row"}})}),p.map(i=>{const g=o[i.id];return e.jsx(M,{align:i.align,children:i.format?i.format(g,o):String(g??"")},String(i.id))})]},m)}const De=w.memo(Ie),Re=({columns:l,row:o,onSelect:p,selectable:m,selected:d,idField:C="id",onRowClick:h})=>{const[f,r]=w.useState(!1),x=()=>{h&&h(o)},u=t=>{t.stopPropagation(),p&&p(o[C],!d)},i=l[0],g=o[i.id];return e.jsxs(W,{elevation:1,sx:{mb:1,overflow:"hidden",cursor:h?"pointer":"default"},onClick:h?x:void 0,children:[e.jsxs(b,{sx:{display:"flex",alignItems:"center",p:1.5,justifyContent:"space-between"},children:[e.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[m&&e.jsx(b,{sx:{mr:1.5},onClick:u,children:e.jsx(V,{checked:!!d})}),e.jsxs(b,{children:[e.jsx(T,{variant:"body1",fontWeight:"medium",children:String(g??"")}),e.jsx(T,{variant:"body2",color:"text.secondary",children:l[1]&&String(o[l[1].id]??"")})]})]}),e.jsx(L,{size:"small",onClick:t=>{t.stopPropagation(),r(!f)},children:f?e.jsx(le,{}):e.jsx(de,{})})]}),e.jsx(ce,{in:f,timeout:"auto",unmountOnExit:!0,children:e.jsx(b,{sx:{p:1.5,pt:0},children:l.slice(2).map(t=>e.jsxs(b,{sx:{mb:1.5},children:[e.jsxs(T,{variant:"body2",color:"text.secondary",component:"span",children:[t.label,":"]}),e.jsx(T,{variant:"body1",component:"span",sx:{ml:1},children:t.format?t.format(o[t.id],o):String(o[t.id]??"")}),e.jsx(he,{sx:{mt:1.5}})]},String(t.id)))})})]})};function Fe(l){const{columns:o,orderBy:p,order:m,filters:d,onRequestSort:C,onFilterChange:h}=l,[f,r]=w.useState(!1),[x,u]=w.useState(""),i=o.filter(a=>a.filter),g=Object.values(d).filter(a=>a&&typeof a=="string"&&a.length>0).length,t=a=>{i.forEach(k=>{h(k.id,"")}),a&&i.length>0&&h(i[0].id,a)},I=a=>{const k=a.target.value;u(k),t(k)},v=()=>{u(""),t("")};return e.jsxs(b,{sx:{mb:2},children:[e.jsxs(W,{elevation:0,sx:{p:1,mb:1.5,display:"flex",border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(te,{placeholder:"Search all columns...",fullWidth:!0,size:"small",value:x,onChange:I,variant:"standard",InputProps:{startAdornment:e.jsx(_,{position:"start",children:e.jsx(ue,{fontSize:"small"})}),endAdornment:x?e.jsx(_,{position:"end",children:e.jsx(L,{edge:"end",onClick:v,size:"small",children:e.jsx(xe,{fontSize:"small"})})}):null,disableUnderline:!0}}),e.jsx(L,{size:"small",onClick:()=>r(!0),sx:{ml:1},children:e.jsx(pe,{})})]}),g>0&&e.jsxs(b,{sx:{mb:1.5,display:"flex",alignItems:"center"},children:[e.jsxs(T,{variant:"body2",color:"text.secondary",sx:{fontSize:12},children:['Showing results for "',x,'"']}),e.jsx(ge,{label:"Clear",size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:11},onClick:v})]}),e.jsxs(fe,{open:f,onClose:()=>r(!1),fullWidth:!0,maxWidth:"xs",children:[e.jsx(je,{children:"Sort By"}),e.jsx(be,{children:e.jsx($,{container:!0,spacing:1.5,sx:{mt:.5},children:o.map(a=>e.jsx($,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,variant:p===a.id?"contained":"outlined",onClick:()=>{C(a.id),r(!1)},endIcon:p===a.id?m==="asc"?"↑":"↓":null,sx:{justifyContent:"space-between"},size:"small",children:a.label})},String(a.id)))})}),e.jsx(me,{children:e.jsx(Y,{onClick:()=>r(!1),color:"inherit",children:"Cancel"})})]}),g===0&&e.jsx(T,{variant:"body2",color:"text.secondary",children:'No filters are currently applied. Click "Add Filter" to filter the data.'})]})}function Me({columns:l,data:o,defaultSortColumn:p,defaultSortDirection:m,onRowClick:d,rowsPerPageOptions:C=[10,25,50],defaultRowsPerPage:h=10,id:f="data-table",enableSelection:r=!1,selected:x=[],onSelect:u,onSelectAll:i,getRowId:g}){const t=g||(s=>s.id);r&&!g&&console.warn("getRowId should be provided when enableSelection is true. Falling back to assuming row.id exists.");const I=Ce(),v=Se(I.breakpoints.down("sm")),[a,k]=S.useState(p),[D,se]=S.useState(m),[R,A]=S.useState(0),[y,q]=S.useState(v?Math.min(5,h):h),[F,ne]=S.useState({});S.useEffect(()=>{v&&y>5&&q(5)},[v,y]);const E=s=>{se(a===s&&D==="asc"?"desc":"asc"),k(s)},H=(s,n)=>{A(n)},K=s=>{q(parseInt(s.target.value,10)),A(0)},N=(s,n)=>{ne(c=>({...c,[s]:n})),A(0)},O=(s,n)=>n.split(".").reduce((c,j)=>{if(c&&typeof c=="object")return c[j]},s),G=(s,n)=>{if(s===n)return 0;if(s==null)return-1;if(n==null)return 1;if(s instanceof Date&&n instanceof Date)return s.getTime()-n.getTime();const c=s,j=n;return typeof c==typeof j?c<j?-1:1:String(s).localeCompare(String(n))},z=S.useMemo(()=>[...o.filter(n=>Object.entries(F).every(([c,j])=>{if(!j)return!0;const P=l.find(X=>X.id===c);if(P!=null&&P.filterValue)return P.filterValue(n).toLowerCase().includes(j.toLowerCase());const re=O(n,c);return String(re).toLowerCase().includes(j.toLowerCase())}))].sort((n,c)=>{const j=O(n,a),P=O(c,a);return D==="desc"?G(P,j):G(j,P)}),[o,D,a,F,l]),B=S.useMemo(()=>{const s=R*y;return z.slice(s,s+y)},[z,R,y]),J=w.useMemo(()=>r?B.map(t):[],[B,r,t]),U=(s,n)=>{u&&u(s,n)},ae=s=>{i&&i(s,J)},Q=s=>r?x.includes(t(s)):!1;return v?e.jsxs(b,{sx:{width:"100%"},children:[e.jsx(Fe,{columns:l,orderBy:a,order:D,filters:F,onRequestSort:E,onFilterChange:N}),e.jsx(ve,{spacing:1,children:B.map((s,n)=>e.jsx(Re,{row:s,columns:l,selectable:r,selected:Q(s),onSelect:U,idField:g?void 0:"id",onRowClick:d?c=>d(c):void 0},n))}),e.jsx(Z,{rowsPerPageOptions:[5,10],component:"div",count:z.length,rowsPerPage:y,page:R,onPageChange:H,onRowsPerPageChange:K,sx:{".MuiTablePagination-selectLabel":{display:{xs:"none",sm:"block"}},".MuiTablePagination-displayedRows":{margin:"0 auto"}}})]}):e.jsxs(b,{sx:{width:"100%"},children:[e.jsx(ye,{component:W,children:e.jsxs(Pe,{id:f,children:[e.jsx(we,{columns:l,orderBy:a,order:D,onRequestSort:E,filters:F,onFilterChange:N,enableSelection:r,selected:x,onSelectAll:ae,visibleRowIds:J}),e.jsx(ke,{children:B.map((s,n)=>e.jsx(De,{row:s,columns:l,index:n,onClick:d,enableSelection:r,selected:Q(s),onSelect:U,rowId:r?t(s):void 0},r?t(s):n))})]})}),e.jsx(Z,{rowsPerPageOptions:C,component:"div",count:z.length,rowsPerPage:y,page:R,onPageChange:H,onRowsPerPageChange:K})]})}export{Me as D};
