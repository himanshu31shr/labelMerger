import{j as e,B as a,C as P,ar as N,aV as z,z as T,X as I,V as D,aC as V,b,a6 as $,D as B,aD as E,aE as y}from"./mui-vendor-tGclxw8b.js";import{a as p,b as F}from"./react-vendor-DYr15v6v.js";import{a as A,C as M,u as H,f as O,v as C}from"./index-Cb91SdTK.js";import{D as R}from"./DataTable-DEz7wYai.js";import{F as u}from"./FormattedCurrency-BQf40NSG.js";import{V as W,a as U,S as q}from"./ActionButtons-D6QB-2Vj.js";import"./redux-vendor-CLOwJCHO.js";import"./firebase-vendor-yCdHbQaA.js";import"./utils-vendor-CFocuF-S.js";import"./pdf-vendor-BVWGQTu2.js";const v=({mode:n="price"})=>{const{items:l,loading:c}=A(t=>t.products),[s,d]=p.useState({}),x=p.useMemo(()=>new M,[]);p.useEffect(()=>{(async()=>{const i={};for(const r of l){const f=await x.getProductCostPrice(r.sku);i[r.sku]={value:f.value,source:f.source}}d(i)})()},[l,x]);let m=[];n==="price"?m=l.filter(t=>{var i;return(t==null?void 0:t.competitionAnalysis)&&Number((i=t==null?void 0:t.competitionAnalysis)==null?void 0:i.competitorPrice)>0&&t.sellingPrice>Number(t.competitionAnalysis.competitorPrice)}):m=l.filter(t=>!(t!=null&&t.existsOnSellerPage));const h=[{id:"sku",label:"SKU",filter:!0},{id:"name",label:"Name",filter:!0},{id:"platform",label:"Platform",filter:!0},{id:"costPrice",label:"Cost Price",align:"right",format:(t,i)=>{var g;if(!(i!=null&&i.sku)||!s[i.sku])return null;const{value:r,source:f}=s[i.sku],j=Number(((g=i==null?void 0:i.metadata)==null?void 0:g.moq)??"1");return e.jsx(N,{title:`Inherited from ${f}`,children:e.jsxs(a,{children:[e.jsx(u,{value:r*j}),e.jsxs(a,{fontSize:12,children:[e.jsx(u,{value:r})," x ",j]})]})})}},{id:"sellingPrice",label:"Selling Price",align:"center",format:(t,i)=>{var r;return e.jsxs(e.Fragment,{children:[e.jsx(u,{value:t}),e.jsxs(a,{gap:1,color:"red",fontSize:12,display:"flex",alignContent:"center",justifyContent:"center",children:[e.jsx(u,{value:((i==null?void 0:i.sellingPrice)??0)-Number((r=i==null?void 0:i.competitionAnalysis)==null?void 0:r.competitorPrice)}),e.jsx(z,{style:{fontSize:12}})]})]})}},{id:"competitorPrice",label:"Competitor Price",align:"right",format:(t,i)=>{var r;return(r=i==null?void 0:i.competitionAnalysis)!=null&&r.competitorPrice?e.jsx(u,{value:Number(i.competitionAnalysis.competitorPrice)}):null}},{id:"actions",label:"Actions",align:"center",format:(t,i)=>o(i)}],o=t=>{var i,r;return e.jsxs(e.Fragment,{children:[((i=t.metadata)==null?void 0:i.flipkartSerialNumber)&&t.platform==="flipkart"&&e.jsx(W,{flipkartSerialNumber:t.metadata.flipkartSerialNumber}),((r=t.metadata)==null?void 0:r.amazonSerialNumber)&&t.platform==="amazon"&&e.jsx(U,{amazonSerialNumber:t.metadata.amazonSerialNumber}),e.jsx(q,{sku:t.sku,platform:t.platform})]})};return c?e.jsx(a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px"},children:e.jsx(P,{})}):e.jsx(a,{sx:{width:"100%"},children:e.jsx(R,{columns:h,data:m,defaultSortColumn:"sku",defaultSortDirection:"asc",rowsPerPageOptions:[10,25,50],defaultRowsPerPage:10})})};function S(n){const{children:l,value:c,index:s,...d}=n;return e.jsx("div",{role:"tabpanel",hidden:c!==s,id:`product-tabpanel-${s}`,"aria-labelledby":`product-tab-${s}`,...d,children:c===s&&e.jsx(a,{sx:{py:3},children:l})})}function k(n){return{id:`product-tab-${n}`,"aria-controls":`product-tabpanel-${n}`}}const ee=()=>{const n=H(),{filteredItems:l,loading:c}=A(o=>o.products),[s,d]=F.useState(0);p.useEffect(()=>{n(O({}))},[n]);const x=(o,t)=>{d(t),n(t===0?C({visibility:"hidden"}):C({}))},m=l.filter(o=>!o.existsOnSellerPage),h=l.filter(o=>o.competitionAnalysis&&Number(o.competitionAnalysis.competitorPrice)>0&&o.sellingPrice>Number(o.competitionAnalysis.competitorPrice));return e.jsx(T,{maxWidth:"xl",sx:{py:3},children:e.jsxs(I,{sx:{p:3,mb:4,borderRadius:2},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:3},children:[s===0?e.jsx(D,{sx:{fontSize:32,mr:2,color:"info.main"}}):e.jsx(V,{sx:{fontSize:32,mr:2,color:"error.main"}}),e.jsx(b,{variant:"h4",component:"h1",sx:{fontWeight:"bold",color:s===0?"info.dark":"error.dark"},children:s===0?"Hidden Products":"Price Management"}),e.jsx($,{label:s===0?`${m.length} Hidden`:`${h.length} Products`,color:s===0?"info":"error",sx:{ml:2,fontWeight:"bold"}})]}),e.jsx(B,{sx:{mb:3}}),e.jsx(a,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(E,{value:s,onChange:x,"aria-label":"product management tabs",sx:{"& .MuiTab-root":{fontWeight:"bold"},"& .Mui-selected":{color:s===0?"info.main":"error.main"},"& .MuiTabs-indicator":{backgroundColor:s===0?"info.main":"error.main"}},children:[e.jsx(y,{label:"Hidden Products",...k(0)}),e.jsx(y,{label:"Update Pricing",...k(1)})]})}),e.jsx(S,{value:s,index:0,children:c?e.jsx(a,{display:"flex",justifyContent:"center",alignItems:"center",m:4,children:e.jsx(P,{color:"info"})}):e.jsxs(a,{children:[e.jsx(b,{variant:"subtitle1",sx:{mb:2,color:"text.secondary"},children:"Manage products that are currently hidden from your listings. You can update visibility status or adjust pricing."}),e.jsx(v,{mode:"hidden"})]})}),e.jsx(S,{value:s,index:1,children:c?e.jsx(a,{display:"flex",justifyContent:"center",alignItems:"center",m:4,children:e.jsx(P,{color:"error"})}):e.jsxs(a,{children:[e.jsx(b,{variant:"subtitle1",sx:{mb:2,color:"text.secondary"},children:"Identify products where your price is higher than competitors. Adjust pricing to remain competitive."}),e.jsx(v,{})]})})]})})};export{ee as HiddenProductsPage,ee as default};
