# Uptime Monitoring Setup

This document outlines the uptime monitoring configuration for the Sacred Sutra Tools application.

## Overview

Our uptime monitoring strategy uses both internal health checks and external monitoring services to ensure application availability and performance.

## Internal Health Checks

### Health Endpoint
- **URL**: `/flipkart-amazon-tools/health`
- **Method**: GET
- **Expected Response**: 200 OK with JSON health data
- **Timeout**: 10 seconds
- **Check Frequency**: Every 1 minute

### Health Check Components
1. **Application Status**: Core React app functionality
2. **Service Availability**: Firebase connection, authentication
3. **Performance Metrics**: Page load times, resource loading
4. **Error Rates**: Recent error counts and severity levels

## External Monitoring Services

### Recommended Services

#### 1. UptimeRobot
**Free tier includes:**
- 50 monitors
- 5-minute check intervals
- Public status pages
- Email/SMS alerts

**Setup:**
```bash
# Monitor URLs
Production: https://himankarr.github.io/flipkart-amazon-tools/health
Health Check: https://himankarr.github.io/flipkart-amazon-tools/

# Alert contacts
Email: your-team@domain.com
SMS: +1234567890

# Check interval: 5 minutes
# Timeout: 30 seconds
```

#### 2. Pingdom
**Features:**
- Global monitoring locations
- Real user monitoring
- Performance insights
- Advanced alerting

**Configuration:**
```javascript
// Pingdom check configuration
{
  "name": "Sacred Sutra Tools Health",
  "host": "himankarr.github.io",
  "url": "/flipkart-amazon-tools/health",
  "checkrate": 300, // 5 minutes
  "sendnotificationwhendown": 2,
  "notifyagainevery": 0,
  "tags": "production,health,webapp"
}
```

#### 3. StatusCake
**Setup:**
```yaml
monitors:
  - name: "Sacred Sutra Tools"
    url: "https://himankarr.github.io/flipkart-amazon-tools/"
    test_type: "HTTP"
    check_rate: 300
    timeout: 10
    follow_redirects: true
    final_endpoint: "https://himankarr.github.io/flipkart-amazon-tools/health"
    
  - name: "Sacred Sutra Tools API Health"
    url: "https://himankarr.github.io/flipkart-amazon-tools/health"
    test_type: "HTTP"
    check_rate: 60
    timeout: 10
    status_codes_csv: "200"
```

## GitHub Actions Monitoring

### Continuous Health Checks
```yaml
# .github/workflows/uptime-monitoring.yml
name: Uptime Monitoring

on:
  schedule:
    - cron: '*/5 * * * *'  # Every 5 minutes
  workflow_dispatch:

jobs:
  uptime-check:
    runs-on: ubuntu-latest
    steps:
      - name: Check Application Health
        run: |
          response=$(curl -s -o /dev/null -w "%{http_code}" \
            https://himankarr.github.io/flipkart-amazon-tools/health)
          
          if [ $response -eq 200 ]; then
            echo "âœ… Application is healthy"
          else
            echo "âŒ Application health check failed (HTTP $response)"
            exit 1
          fi

      - name: Check Main Application
        run: |
          response=$(curl -s -o /dev/null -w "%{http_code}" \
            https://himankarr.github.io/flipkart-amazon-tools/)
          
          if [ $response -eq 200 ]; then
            echo "âœ… Main application is accessible"
          else
            echo "âŒ Main application check failed (HTTP $response)"
            exit 1
          fi

      - name: Notify on Failure
        if: failure()
        uses: actions/github-script@v6
        with:
          script: |
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'ðŸš¨ Uptime Alert: Application Down',
              body: `Application health check failed at ${new Date().toISOString()}
              
              **Check Results:**
              - Health endpoint: Failed
              - Main application: Failed
              
              **Action Required:**
              - Investigate deployment status
              - Check GitHub Pages status
              - Review recent changes
              
              **Auto-generated by:** Uptime Monitoring Workflow`,
              labels: ['incident', 'uptime', 'critical']
            });
```

## Alerting Configuration

### Alert Rules
```yaml
alert_rules:
  critical:
    - condition: "http_status != 200"
      duration: "2 minutes"
      notification: "immediate"
      
    - condition: "response_time > 10s"
      duration: "5 minutes"
      notification: "immediate"
      
  warning:
    - condition: "response_time > 5s"
      duration: "10 minutes"
      notification: "delayed"
      
    - condition: "uptime < 99%"
      duration: "1 hour"
      notification: "summary"

notification_channels:
  email:
    - team@domain.com
    - ops@domain.com
  
  slack:
    webhook: "https://hooks.slack.com/..."
    channel: "#alerts"
  
  sms:
    - "+1234567890"  # Only for critical alerts
```

### Status Page Configuration
```yaml
status_page:
  title: "Sacred Sutra Tools Status"
  description: "Application and service status monitoring"
  
  services:
    - name: "Web Application"
      url: "https://himankarr.github.io/flipkart-amazon-tools/"
      
    - name: "Health Check API"
      url: "https://himankarr.github.io/flipkart-amazon-tools/health"
      
    - name: "GitHub Pages"
      description: "Hosting platform status"
      
    - name: "Firebase Services"
      description: "Authentication and database services"

  metrics:
    - response_time
    - uptime_percentage
    - error_rate
    - ssl_certificate_expiry
```

## Performance Monitoring

### Core Web Vitals Tracking
```javascript
// Performance thresholds
const performance_thresholds = {
  first_contentful_paint: 1800,    // ms
  largest_contentful_paint: 2500,  // ms
  first_input_delay: 100,          // ms
  cumulative_layout_shift: 0.1,    // score
  time_to_interactive: 3800        // ms
};

// Alert when thresholds exceeded
const performance_alerts = {
  warning: "75th percentile exceeds threshold",
  critical: "90th percentile exceeds threshold"
};
```

### Custom Metrics
```yaml
custom_metrics:
  - name: "Page Load Time"
    type: "histogram"
    buckets: [100, 500, 1000, 2500, 5000, 10000]
    
  - name: "Error Rate"
    type: "counter"
    labels: ["severity", "component"]
    
  - name: "User Sessions"
    type: "gauge"
    description: "Active user sessions"
```

## Incident Response

### Escalation Matrix
```
Level 1 (0-5 min):
  - Automated retry
  - Log incident
  - Check recent deployments

Level 2 (5-15 min):
  - Page on-call engineer
  - Create incident ticket
  - Begin investigation

Level 3 (15+ min):
  - Escalate to team lead
  - Consider rollback
  - Public status update
```

### Recovery Procedures
1. **Immediate Actions**
   - Check GitHub Pages status
   - Verify DNS resolution
   - Review deployment logs

2. **Investigation Steps**
   - Check application logs
   - Verify Firebase connectivity
   - Test health endpoints manually

3. **Recovery Options**
   - Trigger manual deployment
   - Rollback to previous version
   - Contact GitHub Support (if needed)

## Setup Instructions

### 1. External Service Setup
```bash
# Choose one or more monitoring services
# Configure with the URLs and settings above
# Set up alerting rules and notification channels
```

### 2. GitHub Actions (Optional)
```bash
# Add the uptime-monitoring.yml workflow
# Configure repository secrets for notifications
# Enable workflow in repository settings
```

### 3. Internal Monitoring
```bash
# Already included in the application
# Monitor via /monitoring/ dashboard
# Check /health/ endpoint for status
```

### 4. Status Page (Optional)
```bash
# Set up public status page
# Configure service monitors
# Add to main navigation or footer
```

## Testing

### Manual Testing
```bash
# Test health endpoint
curl -v https://himankarr.github.io/flipkart-amazon-tools/health

# Test main application
curl -v https://himankarr.github.io/flipkart-amazon-tools/

# Test with monitoring tools
curl -w "@curl-format.txt" -o /dev/null -s \
  https://himankarr.github.io/flipkart-amazon-tools/health
```

### Automated Testing
```javascript
// Include in smoke tests
describe('Uptime Monitoring', () => {
  it('should return healthy status', async () => {
    const response = await fetch('/health');
    expect(response.status).toBe(200);
    
    const data = await response.json();
    expect(data.status).toBe('healthy');
  });
});
```

## Maintenance

### Regular Tasks
- Review alert thresholds monthly
- Update contact information quarterly
- Test alert channels monthly
- Review performance trends weekly

### Annual Tasks
- Review monitoring service contracts
- Update incident response procedures
- Audit alerting effectiveness
- Benchmark against industry standards

## Documentation Links

- [Health Check Implementation](../src/pages/health/health.page.tsx)
- [Monitoring Dashboard](../src/pages/admin/monitoring-dashboard.page.tsx)
- [Deployment Validation](../.github/workflows/deployment-validation.yml)
- [Smoke Tests](../scripts/smoke-tests.js) 